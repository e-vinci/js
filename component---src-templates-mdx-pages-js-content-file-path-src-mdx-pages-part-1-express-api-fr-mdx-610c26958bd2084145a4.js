"use strict";(self.webpackChunkmyjscourse=self.webpackChunkmyjscourse||[]).push([[8327],{3863:function(e,t,n){n.r(t),n.d(t,{default:function(){return A}});var l=n(3905),r=n(7294);function a(e){const t=Object.assign({h1:"h1",h2:"h2",p:"p",strong:"strong",br:"br",ul:"ul",li:"li",table:"table",thead:"thead",tr:"tr",th:"th",tbody:"tbody",td:"td",code:"code",a:"a",pre:"pre",h4:"h4"},(0,l.ah)(),e.components),{InternalPageMenu:n,PathViewer:a,PathViewerItem:s,InternalPageMenuItem:o,InternalPageTitle:c,YoutubeImage:i,ScrollableImage:m}=t;return n||u("InternalPageMenu",!0),o||u("InternalPageMenuItem",!0),c||u("InternalPageTitle",!0),a||u("PathViewer",!0),s||u("PathViewerItem",!0),m||u("ScrollableImage",!0),i||u("YoutubeImage",!0),r.createElement(r.Fragment,null,r.createElement(t.h1,null,"a) Introduction aux RESTful API en Node.js & Express"),"\n",r.createElement(n,null,r.createElement(a,null,r.createElement(s,{to:"/"}," web2course "),r.createElement(s,{to:"/part1"}," Partie 1 "),r.createElement(s,{selected:!0}," a) RESTful API ")),r.createElement(o,null," Introduction aux RESTful API & conventions "),r.createElement(o,null," Configuration & d√©marrage d'une RESTful API en Express "),r.createElement(o,null," Les fonctions middleware en Express "),r.createElement(o,null," D√©finition d'une route en Express "),r.createElement(o,null," Op√©rations de lecture "),r.createElement(o,null," Exercice 1.1 : lecture de toutes les ressources "),r.createElement(o,null," Exercice 1.2 : middleware s'ex√©cutant sur toutes les routes "),r.createElement(o,null," Param√®tres de route "),r.createElement(o,null," Param√®tres de requ√™te "),r.createElement(o,null," Op√©ration de cr√©ation & parsing du body "),r.createElement(o,null," Client REST "),r.createElement(o,null," Exercice 1.3 : lectures sp√©cifiques, cr√©ation & REST Client "),r.createElement(o,null," üç¨ Exercice 1.4 : Gestion de la pagination, du tri et du filtrage "),r.createElement(o,null," Codes de statut HTTP associ√©s aux r√©ponses "),r.createElement(o,null," Exercice 1.5 : codes de statut HTTP "),r.createElement(o,null," Op√©rations de suppression & de modification "),r.createElement(o,null," Exercice 1.6 : suppression & modification de ressources ")),"\n",r.createElement(t.h1,null,r.createElement(c,null," Introduction aux RESTful API & conventions ")),"\n",r.createElement(t.h2,null,"C'est quoi une application REST ?"),"\n",r.createElement("div",{className:"card card__simple-youtube-container"},r.createElement(i,{src:"https://youtu.be/EIESrlEV-CQ"})),"\n",r.createElement(t.p,null,r.createElement(t.strong,null,"REST")," vient de ",r.createElement(t.strong,null,"RE"),"presentational ",r.createElement(t.strong,null,"S"),"tate ",r.createElement(t.strong,null,"T"),"ransfer : c'est un style architectural pour construire des applications web extensibles, o√π les client et serveurs sont s√©par√©s."),"\n",r.createElement(t.p,null,"Dans une application REST, une ",r.createElement(t.strong,null,"interface uniforme")," (ou API) est d√©finie afin de permettre √† des applications de coop√©rer."),"\n",r.createElement(t.p,null,"Toute application REST se doit d'√™tre ",r.createElement(t.strong,null,"stateless")," : il n'y a pas d'enregistrement du contexte d'une session sur le serveur pour comprendre une requ√™te d'un client.",r.createElement(t.br),"\n","Ainsi, les requ√™tes clientes ne d√©pendent pas d'un historique de requ√™tes, chaque requ√™te contient tout l'information n√©cessaire au serveur."),"\n",r.createElement(t.p,null,"Une RESTful API met √† disposition des ",r.createElement(t.strong,null,"op√©rations")," sur des ",r.createElement(t.strong,null,"ressources")," via :"),"\n",r.createElement(t.ul,null,"\n",r.createElement(t.li,null,"des ",r.createElement(t.strong,null,"URI")," ; il y a donc une adresse unique pur chaque ressource ;"),"\n",r.createElement(t.li,null,"des ",r.createElement(t.strong,null,"m√©thodes HTTP")," (GET, POST, DELETE, PATCH, PUT) repr√©sentant les op√©rations possibles ; on parle souvent d'op√©rations ",r.createElement(t.strong,null,"CRUD"),", des op√©rations de type ",r.createElement(t.strong,null,"C"),"reate, ",r.createElement(t.strong,null,"R"),"ead, ",r.createElement(t.strong,null,"U"),"pdate ou ",r.createElement(t.strong,null,"D"),"elete) ;"),"\n",r.createElement(t.li,null,"des ",r.createElement(t.strong,null,"repr√©sentations"),' des ressources compr√©hensibles tant par les clients que les serveurs ; les ressources sont repr√©sent√©es par leur "Media type" : ',r.createElement(t.strong,null,"JSON"),", ",r.createElement(t.strong,null,"XML"),", ",r.createElement(t.strong,null,"HTML"),", ",r.createElement(t.strong,null,"TXT"),", ",r.createElement(t.strong,null,"JPEG"),"... ; dans le cadre de ce cours, les ressources seront quasi toujours repr√©sent√©es via du ",r.createElement(t.strong,null,"JSON"),"."),"\n"),"\n",r.createElement(t.h2,null,"Conventions REST"),"\n",r.createElement(t.p,null,"Le type d'op√©ration CRUD sur une ressource est d√©fini via la ",r.createElement(t.strong,null,"m√©thode http")," de la requ√™te.",r.createElement(t.br),"\n","Les op√©rations possibles sont :"),"\n",r.createElement(t.ul,null,"\n",r.createElement(t.li,null,"GET = Read"),"\n",r.createElement(t.li,null,"POST = Create"),"\n",r.createElement(t.li,null,"DELETE = Delete üòâ"),"\n",r.createElement(t.li,null,"PATCH / PUT = Update","\n",r.createElement(t.ul,null,"\n",r.createElement(t.li,null,"PATCH = Update d'une ou plusieurs propri√©t√©(s) de la ressources"),"\n",r.createElement(t.li,null,"PUT = Update de toutes les propri√©t√©s de la ressources, ou cr√©ation si la ressource n'existe pas"),"\n"),"\n"),"\n"),"\n",r.createElement(t.p,null,"Voici un exemple d'application de ces conventions REST dans le cadre d'une RESTful API permettant de g√©rer des ",r.createElement(t.strong,null,"posts")," :"),"\n",r.createElement(t.table,null,r.createElement(t.thead,null,r.createElement(t.tr,null,r.createElement(t.th,null,"URI"),r.createElement(t.th,null,"M√©thode HTTP"),r.createElement(t.th,null,"Op√©ration"))),r.createElement(t.tbody,null,r.createElement(t.tr,null,r.createElement(t.td,null,r.createElement(t.strong,null,r.createElement(t.code,null,"posts"))),r.createElement(t.td,null,"GET"),r.createElement(t.td,null,"READ ALL : Lire toutes les ressources de la collection")),r.createElement(t.tr,null,r.createElement(t.td,null,r.createElement(t.strong,null,r.createElement(t.code,null,"posts?userId=value"))),r.createElement(t.td,null,"GET"),r.createElement(t.td,null,"READ ALL FILTERED : Lire toutes les ressources de la collection selon le filtre donn√©")),r.createElement(t.tr,null,r.createElement(t.td,null,r.createElement(t.strong,null,r.createElement(t.code,null,"posts/{id}"))),r.createElement(t.td,null,"GET"),r.createElement(t.td,null,"READ ONE : Lire la ressource identifi√©e")),r.createElement(t.tr,null,r.createElement(t.td,null,r.createElement(t.strong,null,r.createElement(t.code,null,"posts"))),r.createElement(t.td,null,"POST"),r.createElement(t.td,null,"CREATE ONE : Cr√©er une ressource bas√©e sur les donn√©es de la requ√™te")),r.createElement(t.tr,null,r.createElement(t.td,null,r.createElement(t.strong,null,r.createElement(t.code,null,"posts/{id}"))),r.createElement(t.td,null,"DELETE"),r.createElement(t.td,null,"DELETE ONE : Effacer la ressource identifi√©e")),r.createElement(t.tr,null,r.createElement(t.td,null,r.createElement(t.strong,null,r.createElement(t.code,null,"posts/{id}"))),r.createElement(t.td,null,"PUT"),r.createElement(t.td,null,"UPDATE ONE : Remplacer l'enti√®ret√© de la ressource par les donn√©es de la requ√™te")))),"\n",r.createElement("br"),"\n",r.createElement(t.p,null,"Lors de l'ajout d'un post, si cette API est h√©berg√©e √† l'URL racine ",r.createElement(t.strong,null,r.createElement(t.a,{href:"https://jsonplaceholder.typicode.com/"},"https://jsonplaceholder.typicode.com/")),", alors nous pourrions identifier une ressource de type ",r.createElement(t.strong,null,"posts")," de cette fa√ßon : ",r.createElement(t.strong,null,r.createElement(t.a,{href:"https://jsonplaceholder.typicode.com/posts/10"},"https://jsonplaceholder.typicode.com/posts/10")),"."),"\n",r.createElement(t.p,null,"Pour lire cette ressource, il faudrait faire une requ√™te http de type ",r.createElement(t.strong,null,"GET")," sur cette ",r.createElement(t.strong,null,"URL")," : ",r.createElement(t.strong,null,r.createElement(t.a,{href:"https://jsonplaceholder.typicode.com/posts/10"},"https://jsonplaceholder.typicode.com/posts/10")),"."),"\n",r.createElement(t.h1,null,r.createElement(c,null," Configuration & d√©marrage d'une RESTful API en Express ")),"\n",r.createElement("div",{className:"card card__simple-youtube-container"},r.createElement(i,{src:"https://youtu.be/pnf0FDNvkto"})),"\n",r.createElement(t.h2,null,"Cr√©ation d'un projet"),"\n",r.createElement(t.p,null,'Nous allons maintenant cr√©er notre toute premi√®re RESTful API pour g√©rer les donn√©es associ√©es √† une pizzeria, afin de b√©n√©ficier d\'op√©rations sur des ressources de type "pizzas".'),"\n",r.createElement(t.p,null,"Dans votre repo ",r.createElement(t.strong,null,"web2"),", veuillez cr√©er le r√©pertoire ",r.createElement(t.strong,null,r.createElement(t.code,null,"/tutorials/pizzeria/api")),"."),"\n",r.createElement(t.p,null,"Veuillez ouvrir un terminal au niveau de ce r√©pertoire."),"\n",r.createElement(t.p,null,"Dans ce r√©pertoire, veuillez g√©n√©rer une application express nomm√©e ",r.createElement(t.strong,null,"basic"),".",r.createElement(t.br),"\n","Pour ce faire :"),"\n",r.createElement(t.pre,null,r.createElement(t.code,{className:"language-bash"},"npx express-generator --no-view basic\n")),"\n",r.createElement(t.p,null,"Veuillez installer les d√©pendances :"),"\n",r.createElement(t.pre,null,r.createElement(t.code,{className:"language-bash"},"cd basic\r\nnpm i\n")),"\n",r.createElement(t.p,null,"Pour la suite du tutoriel, nous consid√©rons que tous les chemins absolus d√©marrent du r√©pertoire ",r.createElement(t.strong,null,r.createElement(t.code,null,"/tutorials/pizzeria/api/basic"))," (ou ",r.createElement(t.strong,null,r.createElement(t.code,null,"/web2/tutorials/pizzeria/api/basic"))," si l'on consid√®re le nom du r√©pertoire du repo)."),"\n",r.createElement(t.p,null,"Nous allons d√©velopper des RESTful API qui ne poss√®dent pas de serveur de fichiers statiques.",r.createElement(t.br),"\n","On n'a donc pas besoin d'avoir un r√©pertoire ",r.createElement(t.strong,null,r.createElement(t.code,null,"/public"))," ni d'un serveur statique.",r.createElement(t.br),"\n","On peut donc effacer le r√©pertoire ",r.createElement(t.strong,null,r.createElement(t.code,null,"/public"))," et supprimer le middleware de serveur de fichiers statiques au sein de ",r.createElement(t.strong,null,r.createElement(t.code,null,"/app.js"))," (en supprimant cette ligne) :"),"\n",r.createElement(t.pre,null,r.createElement(t.code,{className:"language-js"},"app.use(express.static(path.join(__dirname, 'public'))); \n")),"\n",r.createElement(t.h2,null,"Fonctionnement d'une application Express"),"\n",r.createElement(t.p,null,"Nous allons maintenant nous attarder √† comprendre les concepts associ√©s √† l'utilisation d'Express, mais en focalisant sur ceux utiles aux applications REST.",r.createElement(t.br),"\n","Voici comment une requ√™te faite √† une application Express est trait√©e :"),"\n",r.createElement(m,{name:"express-flow.png",minWidth:"800px",maxWidth:"800px"}),"\n",r.createElement("figcaption",null,"Flux d'une requ√™te vers une application Express [R.51]"),"\n",r.createElement(t.p,null,"Dans ce flux de traitement d'une requ√™te, la responsabilit√© des d√©veloppeurs est de s'occuper de la partie \"Middleware\"."),"\n",r.createElement(t.p,null,'La grande majorit√© du code √©crit sera du "routing middleware" : notre code s\'occupera de r√©pondre √† des requ√™tes clientes pour diff√©rentes URLs et m√©thodes HTTP (GET, POST...).'),"\n",r.createElement(t.p,null,"On l'a d√©j√† vu, la configuration d'une application Express, comme toutes applications Node.js, est faite au sein de ",r.createElement(t.strong,null,r.createElement(t.code,null,"package.json")),"."),"\n",r.createElement(t.p,null,"En fonction de comment est configur√© l'application, on la d√©marrera via ",r.createElement(t.strong,null,r.createElement(t.code,null,"npm start")),", ",r.createElement(t.strong,null,r.createElement(t.code,null,"npm run dev")),", ",r.createElement(t.strong,null,r.createElement(t.code,null,"npm run build")),"..."),"\n",r.createElement(t.p,null,"Un ",r.createElement(t.strong,null,"serveur web int√©gr√©")," √† nos applications Express est d√©marr√© au sein du fichier ",r.createElement(t.strong,null,r.createElement(t.code,null,"bin/www")),"."),"\n",r.createElement(t.p,null,"C'est ce fichier que vous devez mettre √† jour si par exemple vous souhaitez que votre application fonctionne sur un port diff√©rent que le port par d√©faut ",r.createElement(t.strong,null,"3000"),"."),"\n",r.createElement(t.p,null,"Un serveur int√©gr√© est diff√©rent d'une application web offerte par un serveur standalone comme Apache, Tomcat... C'est un serveur tr√®s l√©ger d√©di√© √† votre application."),"\n",r.createElement(t.h1,null,r.createElement(c,null," Les fonctions middleware en Express ")),"\n",r.createElement(t.h2,null,"C'est quoi une fonction middleware ?"),"\n",r.createElement(t.p,null,"Les fonctions middleware s'occupent du traitement des requ√™tes des clients et de la pr√©paration des r√©ponses :"),"\n",r.createElement(m,{name:"middlewares.jpg",minWidth:"638px",maxWidth:"638px"}),"\n",r.createElement("figcaption",null,"Les fonctions Middleware et Express [R.52]"),"\n",r.createElement(t.p,null,"Une fonction middleware a acc√®s aux objets de la requ√™te et de la r√©ponse et peut utiliser la requ√™te et la r√©ponse pour ajouter, par exemple, un log, pour autoriser un utilisateur, pour parser des donn√©es Json vers des objets JS, pour servir des fichiers statiques, pour faire un traitement pour une route bien sp√©cifique..."),"\n",r.createElement(t.p,null,"Lors de l'ajout d'un film, si une fonction middleware ne termine pas le cycle de requ√™te-r√©ponse, elle doit appeler ",r.createElement(t.strong,null,r.createElement(t.code,null,"next()"))," pour permettre √† d'autres fonctions qui sont dans la queue de pouvoir √™tre ex√©cut√©es."),"\n",r.createElement(t.p,null,"Voici les √©l√©ments associ√©s √† l'appel d'une fonction middleware :"),"\n",r.createElement(m,{name:"middleware-function.png",minWidth:"944px",maxWidth:"944px"}),"\n",r.createElement("figcaption",null,"Une fonction middleware [R.53]"),"\n",r.createElement(t.p,null,"Il existe diff√©rents types de fonctions middleware ayant diff√©rents cas d'utilisation :"),"\n",r.createElement(t.ul,null,"\n",r.createElement(t.li,null,r.createElement(t.strong,null,"Application-level middleware")," : la fonction middleware est li√©e √† l'objet ",r.createElement(t.strong,null,"app")," et peut s'appliquer √† toutes les requ√™tes."),"\n",r.createElement(t.li,null,r.createElement(t.strong,null,"Router-level middleware")," : la fonction middleware est li√©e √† un objet de type ",r.createElement(t.strong,null,r.createElement(t.code,null,"express.router()"))," et est tr√®s similaire au \"application-level middleware\", mais ne s'applique qu'√† un groupe de requ√™tes."),"\n",r.createElement(t.li,null,r.createElement(t.strong,null,"Error-handling middleware")," : fonction de gestion des erreurs qui se d√©finit comme les fonctions ci-dessus (au niveau ",r.createElement(t.strong,null,"app")," ou ",r.createElement(t.strong,null,"router"),"), mais qui contient un quatri√®me param√®tre nomm√© ",r.createElement(t.strong,null,"error"),"."),"\n",r.createElement(t.li,null,r.createElement(t.strong,null,"Built-in middleware")," : fonctions middleware mises √† disposition par Express directement. En voici quelques exemples :","\n",r.createElement(t.ul,null,"\n",r.createElement(t.li,null,r.createElement(t.strong,null,"express.static")," : pour servir des assets statiques ;"),"\n",r.createElement(t.li,null,r.createElement(t.strong,null,"express.json")," : pour parser le body de requ√™tes en JSON vers des objets JS ;"),"\n",r.createElement(t.li,null,r.createElement(t.strong,null,"express.urlencoded"),' : pour parser des requ√™tes dont le body est de type "urlencoded" (type par d√©faut des formulaires) vers des objets JS.'),"\n"),"\n"),"\n",r.createElement(t.li,null,r.createElement(t.strong,null,"Third-party middleware")," : fonctions mises √† disposition par la communaut√© et installables via npm, comme par exemple la fonction middleware ",r.createElement(t.strong,null,"cookieParser"),"."),"\n"),"\n",r.createElement(t.p,null,"La suite fournit quelques exemples de fonctions middleware qui seront soit plus tard rencontr√©es dans notre code, soit sont extraites de la documentation d'Express : ",r.createElement(t.a,{href:"https://expressjs.com/en/guide/using-middleware.html"},"Using middleware")," ",r.createElement(t.a,{href:"/web2/references/#r54"},"[R.54]"),"."),"\n",r.createElement(t.h2,null,"Application-level middleware : exemple"),"\n",r.createElement(t.p,null,"Voici une fonction middleware qui sera ex√©cut√©e √† chaque fois qu'il y a une requ√™te, quelque soit le chemin (ou path) associ√© √† la requ√™te :"),"\n",r.createElement(t.pre,null,r.createElement(t.code,{className:"language-js"},"var¬†express¬†=¬†require('express');\r\nvar¬†app¬†=¬†express();\r\napp.use((req,¬†res,¬†next) =>¬†{\r\n¬†¬†console.log('Time:',¬†Date.now());\r\n¬†¬†next();\r\n});\n")),"\n",r.createElement(t.h2,null,"Router-level middleware : exemple"),"\n",r.createElement(t.p,null,"Voici une partie du code qui se trouverait au sein d'un router de pizzas, dans le fichier ",r.createElement(t.strong,null,"/routes/pizzas.js")," :"),"\n",r.createElement(t.pre,null,r.createElement(t.code,{className:"language-js"},"var¬†router¬†=¬†express.Router();\r\n\r\nrouter.use((req,¬†res,¬†next)¬†=> {\r\n¬†¬†console.log('Time:',¬†Date.now());\r\n¬†¬†next();\r\n});\r\n\r\nrouter.get('/',(req,¬†res,¬†next)¬†=> {\r\n¬†¬†return¬†res.json(menu);\r\n});\n")),"\n",r.createElement(t.p,null,"La premi√®re fonction middleware ne contient pas de m√©thode HTTP, ni de chemin, elle s'applique donc √† toutes les routes associ√©es au router de pizzas.",r.createElement(t.br),"\n","Voici le code qui permettrait, dans ",r.createElement(t.strong,null,"/app.js"),", d'appeler le router de pizzas :"),"\n",r.createElement(t.pre,null,r.createElement(t.code,{className:"language-js"},"var pizzaRouter = require('./routes/pizzas');\r\napp.use('/pizzas', pizzaRouter);\n")),"\n",r.createElement(t.p,null,"Lors de l'ajout d'un film, si le router est utilis√© de cette fa√ßon, en relisant l'avant-dernier snippet, on voit que :"),"\n",r.createElement(t.ul,null,"\n",r.createElement(t.li,null,"la premi√®re fonction (o√π il y a un ",r.createElement(t.code,null,"console.log"),") s'applique donc √† toutes les routes qui commencent par ",r.createElement(t.strong,null,"/pizzas")," ;"),"\n",r.createElement(t.li,null,"la deuxi√®me fonction middleware s'appliquent seulement aux requ√™tes de type ",r.createElement(t.strong,null,"GET")," sur la route (ou le chemin) ",r.createElement(t.strong,null,"/pizzas")," (√©quivalent de la route ",r.createElement(t.strong,null,"/pizzas/"),")."),"\n"),"\n",r.createElement(t.h2,null,"Error-handling middleware : exemple"),"\n",r.createElement(t.p,null,"Ce type de middleware est √† d√©finir apr√®s tous les middlewares pouvant g√©n√©rer une erreur et est appel√© via ",r.createElement(t.strong,null,r.createElement(t.code,null,"next(err)"))," dans une fonction middleware o√π un souci est d√©tect√©."),"\n",r.createElement(t.p,null,"Voici la d√©finition d'un gestionnaire d'erreurs :"),"\n",r.createElement(t.pre,null,r.createElement(t.code,{className:"language-js"},"app.use((err, req, res, next) => {\r\n  console.error(err.stack)\r\n  res.status(500).send('Something broke!')\r\n});\n")),"\n",r.createElement(t.p,null,"Attention, il y a bien 4 param√®tres au lieu des 3 habituels pour les autres types de fonctions middleware."),"\n",r.createElement(t.h2,null,"Built-in middleware & third-party middleware : exemple"),"\n",r.createElement(t.p,null,"Dans ",r.createElement(t.strong,null,"app.js"),", on trouve pas mal d'exemples de ces types de middleware. Ils sont comment√©s ci-dessous dans le code :"),"\n",r.createElement(t.pre,null,r.createElement(t.code,{className:"language-js"},"var express = require('express');\r\nvar path = require('path');\r\nvar cookieParser = require('cookie-parser');\r\nvar logger = require('morgan');\r\n\r\nvar app = express();\r\n\r\napp.use(logger('dev')); //¬†HTTP request logger\r\napp.use(express.json()); //¬†Parse requests with JSON payloads\r\napp.use(express.urlencoded({ extended: false })); //¬†Parse requests with URL-\r\n                                                  // encoded payload \r\napp.use(cookieParser()); //¬†Parse cookie header (req.cookies)\r\napp.use(express.static(path.join(__dirname, 'public'))); //¬†Serve static assets\n")),"\n",r.createElement(t.h1,null,r.createElement(c,null," D√©finition d'une route en Express ")),"\n",r.createElement(t.h2,null,"D√©finition d'une route"),"\n",r.createElement(t.p,null,"Le routing, ou routage, contr√¥le la r√©ponse √† une requ√™te client pour un chemin et une m√©thode HTTP. Le chemin est aussi appel√© ",r.createElement(t.strong,null,"endpoint")," ou ",r.createElement(t.strong,null,"URI")," ou ",r.createElement(t.strong,null,"PATH"),"."),"\n",r.createElement(t.p,null,"On va d√©finir une route soit sur l'objet ",r.createElement(t.strong,null,"app"),", soit sur un ",r.createElement(t.strong,null,"router"),".",r.createElement(t.br),"\n","Un objet de type ",r.createElement(t.strong,null,"router")," permet de regrouper toutes les routes associ√©es √† un type de ressources."),"\n",r.createElement(t.p,null,"On d√©finit une route de cette fa√ßon : ",r.createElement(t.strong,null,r.createElement(t.code,null,"app."))," ou ",r.createElement(t.strong,null,r.createElement(t.code,null,"router.")),"  ",r.createElement(t.strong,null,r.createElement(t.code,null,"METHOD(PATH, MIDDLEWARE_FUNCTION)")),"."),"\n",r.createElement(t.p,null,"üëç Dans notre cours, nous vous recommandons d'organiser vos routes par type de ressources et donc de mettre en place des routers."),"\n",r.createElement(t.h1,null,r.createElement(c,null," Op√©rations de lecture ")),"\n",r.createElement("div",{className:"card card__simple-youtube-container"},r.createElement(i,{src:"https://youtu.be/VrXEj8QhFcw"})),"\n",r.createElement(t.p,null,'Nous souhaitons par commencer √† d√©velopper une op√©ration permettant de lire toutes les ressources de type "pizzas".',r.createElement(t.br),"\n","Veuillez cr√©er un router pour traiter des ressources ",r.createElement(t.strong,null,"/pizzas")," au sein de ",r.createElement(t.strong,null,r.createElement(t.code,null,"/routes/pizzas.js")),".",r.createElement(t.br),"\n","Le plus simple est d'adapter ",r.createElement(t.strong,null,r.createElement(t.code,null,"indexRouter"))," dans ",r.createElement(t.strong,null,r.createElement(t.code,null,"app.js"))," en ",r.createElement(t.strong,null,r.createElement(t.code,null,"pizzaRouter"))," et ",r.createElement(t.strong,null,r.createElement(t.code,null,"/routers/index.js"))," en ",r.createElement(t.strong,null,r.createElement(t.code,null,"/routes/pizzas.js")),".",r.createElement(t.br),"\n","NB : Il est aussi possible de partir de rien et de cr√©er ",r.createElement(t.strong,null,r.createElement(t.code,null,"pizzaRouter"))," dans ",r.createElement(t.strong,null,r.createElement(t.code,null,"app.js"))," et ",r.createElement(t.strong,null,r.createElement(t.code,null,"/routes/pizzas.js")),"."),"\n",r.createElement(t.p,null,"Pour l'op√©ration de lecture de toutes les pizzas, selon les conventions REST, il faut faire une requ√™te de type ",r.createElement(t.strong,null,r.createElement(t.code,null,"GET /pizzas")),". Le router de ",r.createElement(t.strong,null,r.createElement(t.code,null,"/routes/pizzas.js"))," doit donc offrir une route renvoyant toutes les pizzas qui existent dans le menu."),"\n",r.createElement(t.p,null,"Pour d√©marrer, nous souhaitons une application basique qui ne g√®re pas la persistance des donn√©es. Le menu sera donc un array d'objets, chaque objet repr√©sentant une pizza."),"\n",r.createElement(t.p,null,"Notre op√©ration de lecture de pizza va renvoyer du JSON au client, c'est √† dire une repr√©sentation textuelle d'un array d'objets. Nous verrons plus tard ce qu'est r√©ellement le JSON. A ce stade-ci, il est suffisant de conna√Ætre la fonction d'Express qui permet √† un objet JS de circuler sur le r√©seau : ",r.createElement(t.strong,null,r.createElement(t.code,null,"res.json()")),"."),"\n",r.createElement(t.p,null,"Voici le code du router ",r.createElement(t.strong,null,r.createElement(t.code,null,"/routes/pizzas.js"))," :"),"\n",r.createElement(t.pre,null,r.createElement(t.code,{className:"language-js"},"var express = require('express');\r\nvar router = express.Router();\r\n\r\nconst MENU = [\r\n  {\r\n    id: 1,\r\n    title: '4 fromages',\r\n    content: 'Gruy√®re, S√©rac, Appenzel, Gorgonzola, Tomates',\r\n  },\r\n  {\r\n    id: 2,\r\n    title: 'Vegan',\r\n    content: 'Tomates, Courgettes, Oignons, Aubergines, Poivrons',\r\n  },\r\n  {\r\n    id: 3,\r\n    title: 'Vegetarian',\r\n    content: 'Mozarella, Tomates, Oignons, Poivrons, Champignons, Olives',\r\n  },\r\n  {\r\n    id: 4,\r\n    title: 'Alpage',\r\n    content: 'Gruy√®re, Mozarella, Lardons, Tomates',\r\n  },\r\n  {\r\n    id: 5,\r\n    title: 'Diable',\r\n    content: 'Tomates, Mozarella, Chorizo piquant, Jalapenos',\r\n  },\r\n];\r\n\r\n// Read all the pizzas from the menu\r\nrouter.get('/', (req, res, next) => {\r\n  console.log('GET /pizzas');\r\n  res.json(MENU);\r\n});\r\n\r\nmodule.exports = router;\n")),"\n",r.createElement(t.p,null,"Et voici le code de ",r.createElement(t.strong,null,"app.js")," (les parties modifi√©es sont surlign√©es) :"),"\n",r.createElement(t.pre,{numbered:!0,highlighting:"6,16"},r.createElement(t.code,{className:"language-js"},"var express = require('express');\r\nvar path = require('path');\r\nvar cookieParser = require('cookie-parser');\r\nvar logger = require('morgan');\r\n\r\nvar pizzaRouter = require('./routes/pizzas');\r\nvar usersRouter = require('./routes/users');\r\n\r\nvar app = express();\r\n\r\napp.use(logger('dev'));\r\napp.use(express.json());\r\napp.use(express.urlencoded({ extended: false }));\r\napp.use(cookieParser());\r\n\r\napp.use('/pizzas', pizzaRouter);\r\napp.use('/users', usersRouter);\r\n\r\nmodule.exports = app;\n")),"\n",r.createElement(t.p,null,"Veuillez d√©marrer l'API (par d√©faut elle est configur√©e sur le port 3000 au sein de ",r.createElement(t.strong,null,r.createElement(t.code,null,"bin/www")),") :"),"\n",r.createElement(t.pre,null,r.createElement(t.code,{className:"language-bash"},"npm start\n")),"\n",r.createElement(t.p,null,'Pour consommer l\'op√©ration de lecture via un browser, nous pouvons lire toutes les ressources de type "pizzas" ici :\r\n',r.createElement(t.a,{href:"http://localhost:3000/pizzas"},"http://localhost:3000/pizzas")),"\n",r.createElement(t.h1,null,r.createElement(c,null," Exercice 1.1 : lecture de toutes les ressources ")),"\n",r.createElement(t.p,null,"Vous allez cr√©er la premi√®re version de la RESTful API de ",r.createElement(t.strong,null,"myMovies"),", un site qui permettra de pr√©senter des films. Vous devez, sous Express, mettre √† disposition cette op√©ration :"),"\n",r.createElement(t.table,null,r.createElement(t.thead,null,r.createElement(t.tr,null,r.createElement(t.th,null,"URI"),r.createElement(t.th,null,"M√©thode HTTP"),r.createElement(t.th,null,"Op√©ration"))),r.createElement(t.tbody,null,r.createElement(t.tr,null,r.createElement(t.td,null,r.createElement(t.strong,null,r.createElement(t.code,null,"films"))),r.createElement(t.td,null,"GET"),r.createElement(t.td,null,"READ ALL : Lire toutes les ressources de la collection")))),"\n",r.createElement("br"),"\n",r.createElement(t.p,null,"Une ressource de type ",r.createElement(t.strong,null,r.createElement(t.code,null,"films"))," doit contenir les propri√©t√©s suivantes :"),"\n",r.createElement(t.ul,null,"\n",r.createElement(t.li,null,r.createElement(t.strong,null,r.createElement(t.code,null,"id"))," : un entier"),"\n",r.createElement(t.li,null,r.createElement(t.strong,null,r.createElement(t.code,null,"title"))," : titre du film (String)"),"\n",r.createElement(t.li,null,r.createElement(t.strong,null,r.createElement(t.code,null,"duration"))," : dur√©e du film en minutes ; elle doit √™tre un nombre positif (pas une string !)."),"\n",r.createElement(t.li,null,r.createElement(t.strong,null,r.createElement(t.code,null,"budget"))," : pour informer du co√ªt qu'a cout√© la production du film, en millions ; le budget doit √™tre un nombre positif (pas une string !)."),"\n",r.createElement(t.li,null,r.createElement(t.strong,null,r.createElement(t.code,null,"link"))," : pour donner une URL vers la description du film (lien vers imdb, rottentomatoes ou autre)."),"\n"),"\n",r.createElement(t.p,null,'Veuillez donc "hardcoder" au moins trois ressources, parmi vos films pr√©f√©r√©s, dans un array au sein de votre RESTful API.'),"\n",r.createElement(t.p,null,"Le code de votre application doit se trouver dans votre repository local et votre web repository (normalement appel√© ",r.createElement(t.strong,null,r.createElement(t.code,null,"web2")),") dans le r√©pertoire nomm√© ",r.createElement(t.strong,null,r.createElement(t.code,null,"/exercises/1.1")),".",r.createElement(t.br),"\n","Veuillez faire un ",r.createElement(t.strong,null,r.createElement(t.code,null,"commit"))," de votre code avec le message suivant : ",r.createElement(t.strong,null,r.createElement(t.code,null,"1.1 API : read")),"."),"\n",r.createElement(t.h1,null,r.createElement(c,null," Exercice 1.2 : middleware s'ex√©cutant sur toutes les routes ")),"\n",r.createElement(t.h2,null,"Application middleware de base"),"\n",r.createElement(t.p,null,"Veuillez cr√©er un middleware qui permet d'enregistrer et d'afficher dans la console des statistiques sur les requ√™tes faites √† votre API."),"\n",r.createElement(t.p,null,"Vous devez enregistrer, depuis le d√©marrage du serveur, le nombre de requ√™tes ",r.createElement(t.strong,null,r.createElement(t.code,null,"GET"))," faites √† votre API."),"\n",r.createElement(t.p,null,"Voici un example de ce qui devrait √™tre affich√© dans la console √† chaque requ√™te vers votre API :"),"\n",r.createElement(t.pre,null,r.createElement(t.code,{className:"language-bash"},"GET counter : 2\n")),"\n",r.createElement(t.p,null,"Le code de votre application doit se trouver dans votre repository local et votre web repository (normalement appel√© ",r.createElement(t.strong,null,r.createElement(t.code,null,"web2")),") dans le r√©pertoire nomm√© ",r.createElement(t.strong,null,r.createElement(t.code,null,"/exercises/1.2")),".",r.createElement(t.br),"\n","Veuillez faire un ",r.createElement(t.strong,null,r.createElement(t.code,null,"commit"))," de votre code avec le message suivant : ",r.createElement(t.strong,null,r.createElement(t.code,null,"1.2 : app middleware")),"."),"\n",r.createElement(t.h4,null,"ü§ù Tips"),"\n",r.createElement(t.ul,null,"\n",r.createElement(t.li,null,"Comment r√©cup√©rer la m√©thode HTTP ? ",r.createElement(t.strong,null,r.createElement(t.code,null,"req.method"))," ..."),"\n",r.createElement(t.li,null,"Comment appliquer un middleware √† toutes les routes ? revoir les ",r.createElement(t.strong,null,"application-level middleware"),"..."),"\n"),"\n",r.createElement(t.h2,null,"üç¨ Et si on allait un peu plus loin ?"),"\n",r.createElement(t.p,null,"Vous allez maintenant cat√©goriser le nombre d'appels par ",r.createElement(t.strong,null,r.createElement(t.code,null,"PATH"))," et par ",r.createElement(t.strong,null,r.createElement(t.code,null,"m√©thode HTTP")),"."),"\n",r.createElement(t.p,null,"Voici un example de ce qui devrait √™tre affich√© dans la console √† chaque requ√™te vers votre API :"),"\n",r.createElement(t.pre,null,r.createElement(t.code,{className:"language-bash"},"Request counter :\r\n- GET / : 10\r\n- GET /pizzas : 2\r\n- POST /pizzas : 5\r\n- DELETE /pizzas : 2\n")),"\n",r.createElement(t.h1,null,r.createElement(c,null," Param√®tres de route ")),"\n",r.createElement("div",{className:"card card__simple-youtube-container"},r.createElement(i,{src:"https://youtu.be/i-QAbJOppwM"})),"\n",r.createElement(t.p,null,"Les ",r.createElement(t.strong,null,"route parameters")," sont des segments d'une URL qui sont utilis√©s pour capturer une valeur sp√©cifi√©e √† leur position dans l'URL. On r√©cup√®re ces param√®tres via l'objet ",r.createElement(t.strong,null,r.createElement(t.code,null,"req.params")),"."),"\n",r.createElement(t.p,null,"Pour notre pizzeria, nous souhaitons pouvoir lire une pizza identifi√©e par son ",r.createElement(t.strong,null,"id"),"."),"\n",r.createElement(t.p,null,"Nous allons donc ajouter le param√®tre de route ",r.createElement(t.strong,null,"id"),".",r.createElement(t.br),"\n","En respect des conventions REST, un client devra faire ce genre de requ√™te pour appeler cette op√©ration : ",r.createElement(t.strong,null,r.createElement(t.code,null,"GET /pizzas/2")),"."),"\n",r.createElement(t.p,null,"Pour continuer le tutoriel que nous avons initi√© dans le r√©pertoire ",r.createElement(t.strong,null,r.createElement(t.code,null,"/tutorials/pizzeria/api/basic")),",  voici la nouvelle route √† ajouter dans le router ",r.createElement(t.strong,null,r.createElement(t.code,null,"/routes/pizza.js"))," :"),"\n",r.createElement(t.pre,null,r.createElement(t.code,{className:"language-js"},"// Read the pizza identified by an id in the menu\r\nrouter.get('/:id', (req, res) => {\r\n  console.log(`GET /pizzas/${req.params.id}`);\r\n\r\n  const indexOfPizzaFound = MENU.findIndex((pizza) => pizza.id == req.params.id);\r\n\r\n  if (indexOfPizzaFound < 0) return res.sendStatus(404);\r\n\r\n  res.json(MENU[indexOfPizzaFound]);\r\n});\n")),"\n",r.createElement(t.p,null,"Veuillez red√©marrer l'API (",r.createElement(t.strong,null,r.createElement(t.code,null,"CTRL c"))," puis ",r.createElement(t.strong,null,r.createElement(t.code,null,"npm start")),")."),"\n",r.createElement(t.p,null,'Pour consommer cette nouvelle op√©ration via un browser, nous pouvons lire la ressource de type "pizzas" identifi√©e par ',r.createElement(t.strong,null,"2")," dans le menu ainsi :\r\n",r.createElement(t.a,{href:"http://localhost:3000/pizzas/2"},"http://localhost:3000/pizzas/2")),"\n",r.createElement(t.p,null,"Le browser fait bien une requ√™te du genre : ",r.createElement(t.strong,null,r.createElement(t.code,null,"GET /pizzas/2")),".",r.createElement(t.br),"\n",'Le param√®tre de la route "2" est r√©cup√©r√© dans l\'URL de la route par Express et est offert via ',r.createElement(t.strong,null,r.createElement(t.code,null,"req.params.id")),"."),"\n",r.createElement(t.p,null,"N'h√©sitez pas √† faire une requ√™te pour un identifiant n'existant pas de le menu pour voir ce qui se passe : ",r.createElement(t.a,{href:"http://localhost:3000/pizzas/666"},"http://localhost:3000/pizzas/666"),"."),"\n",r.createElement(t.h1,null,r.createElement(c,null," Param√®tres de requ√™te ")),"\n",r.createElement(t.p,null,"Les ",r.createElement(t.strong,null,"query parameters")," sont des param√®tres qui peuvent √™tre ajout√©s √† une URL.",r.createElement(t.br),"\n","On r√©cup√®re ces param√®tres via l'objet ",r.createElement(t.strong,null,r.createElement(t.code,null,"req.query")),"."),"\n",r.createElement(t.p,null,'Pour notre pizzeria, nous souhaitons pouvoir lire toutes les ressources de type "pizzas" tri√©es par ordre ascendant ou descendant du titre.'),"\n",r.createElement(t.p,null,"En respect des conventions REST, un client devra faire ce genre de requ√™tes :"),"\n",r.createElement(t.ul,null,"\n",r.createElement(t.li,null,"pour le tri ascendant : ",r.createElement(t.strong,null,r.createElement(t.code,null,"GET /pizzas?order=title"))," ;"),"\n",r.createElement(t.li,null,"pour le tri descendant : ",r.createElement(t.strong,null,r.createElement(t.code,null,"GET /pizzas?order=-title")),"."),"\n"),"\n",r.createElement(t.p,null,"Il n'y a donc pas de nouvelle route √† ajouter ici. En effet, √ßa reste une requ√™te de type GET sur la route ",r.createElement(t.strong,null,r.createElement(t.code,null,"/pizzas")),"."),"\n",r.createElement(t.p,null,"Veuillez donc mettre √† jour ",r.createElement(t.strong,null,r.createElement(t.code,null,"/routes/pizza.js"))," pour la lecture de toutes les pizzas :"),"\n",r.createElement(t.pre,null,r.createElement(t.code,{className:"language-js"},"/* Read all the pizzas from the menu\r\n   GET /pizzas?order=title¬†:¬†ascending order¬†by¬†title\r\n¬†  GET /pizzas?order=-title¬†:¬†descending order¬†by¬†title\r\n*/\r\nrouter.get('/', (req, res, next) => {\r\n  const orderByTitle =\r\n    req?.query?.order?.includes('title')\r\n      ? req.query.order\r\n      : undefined;\r\n  let orderedMenu;\r\n  console.log(`order by ${orderByTitle ?? 'not requested'}`);\r\n  if (orderByTitle)\r\n    orderedMenu = [...MENU].sort((a, b) => a.title.localeCompare(b.title));\r\n  if (orderByTitle === '-title') orderedMenu = orderedMenu.reverse();\r\n\r\n  console.log('GET /pizzas');\r\n  res.json(orderedMenu ?? MENU);\r\n});\n")),"\n",r.createElement(t.p,null,"Veuillez red√©marrer l'API (",r.createElement(t.strong,null,r.createElement(t.code,null,"CTRL c"))," puis ",r.createElement(t.strong,null,r.createElement(t.code,null,"npm start")),")."),"\n",r.createElement(t.p,null,'Pour consommer cette nouvelle op√©ration via un browser, nous pouvons lire toutes les ressources de type "pizzas" tri√©es par leur titre de mani√®re descendante :\r\n',r.createElement(t.a,{href:"http://localhost:3000/pizzas?order=-title"},"http://localhost:3000/pizzas?order=-title"),"."),"\n",r.createElement(t.p,null,"N'h√©sitez pas √† tester d'autres tris."),"\n",r.createElement(t.h1,null,r.createElement(c,null," Op√©ration de cr√©ation & parsing du body ")),"\n",r.createElement("div",{className:"card card__simple-youtube-container"},r.createElement(i,{src:"https://youtu.be/TwnPu-T7Wm0"})),"\n",r.createElement(t.p,null,'Nous souhaitons d√©velopper une op√©ration permettant de cr√©er une ressource de type "pizzas".',r.createElement(t.br),"\n","Selon les conventions REST, il faut faire une requ√™te de type ",r.createElement(t.strong,null,r.createElement(t.code,null,"POST /pizzas"))," qui offre une repr√©sentation de la ressource √† cr√©er. La repr√©sentation utilis√©e est le JSON que nous verrons plus en d√©tails plus tard.",r.createElement(t.br),"\n",'Lors de l\'ajout d\'un film, si nous souhaitons cr√©er une ressource dont le titre est "Magic Green" et le contenu est "Epinards, Brocolis, Olives vertes, Basilic", la repr√©sentation de la ressource √† cr√©er sera la suivante :'),"\n",r.createElement(t.pre,null,r.createElement(t.code,{className:"language-json"},'{\r\n    "title":"Magic Green",\r\n    "content":"Epinards, Brocolis, Olives vertes, Basilic"\r\n}\n')),"\n",r.createElement(t.p,null,"Selon les conventions REST, une requ√™te de cr√©ation est de type ",r.createElement(t.strong,null,"POST")," et contient ses ",r.createElement(t.strong,null,"param√®tres\r\nau sein du body")," de la requ√™te."),"\n",r.createElement(t.p,null,r.createElement(t.strong,null,r.createElement(t.code,null,"/routes/pizzas.js"))," doit offrir une nouvelle route permettant d'ajouter une nouvelle pizza au menu, qui est un array d'objets. Une nouvelle pizza doit donc √™tre ajout√©e √† une variable, un array, qui est contenu dans la m√©moire vive de notre machine.",r.createElement(t.br),"\n","Lorsque l'ajout d'une pizza au menu a r√©ussi, nous souhaitons renvoyer la repr√©sentation de la nouvelle ressource au client. Ainsi, le client aura notamment acc√®s √† l'",r.createElement(t.strong,null,"id")," de la pizza cr√©√©e par l'API."),"\n",r.createElement(t.p,null,"Voici le code du router ",r.createElement(t.strong,null,r.createElement(t.code,null,"/routes/pizzas.js"))," pour la nouvelle op√©ration. Rajoutons-le dans notre application :"),"\n",r.createElement(t.pre,null,r.createElement(t.code,{className:"language-js"},"// Create a pizza to be added to the menu.\r\nrouter.post('/', (req, res) => {\r\n  const title = req?.body?.title?.length !== 0 ? req.body.title : undefined;\r\n  const content = req?.body?.content?.length !== 0 ? req.body.content : undefined;\r\n\r\n  console.log('POST /pizzas');\r\n\r\n  if (!title || !content) return res.sendStatus(400); // error code '400 Bad request'\r\n\r\n  const lastItemIndex = MENU?.length !== 0 ? MENU.length - 1 : undefined;\r\n  const lastId = lastItemIndex !== undefined ? MENU[lastItemIndex]?.id : 0;\r\n  const nextId = lastId + 1;\r\n\r\n  const newPizza = {\r\n    id: nextId,\r\n    title: title,\r\n    content: content,\r\n  };\r\n\r\n  MENU.push(newPizza);\r\n\r\n  res.json(newPizza);\r\n});\n")),"\n",r.createElement(t.p,null,"La repr√©sentation de la ressource √† cr√©er est pars√©e dans l'objet ",r.createElement(t.strong,null,r.createElement(t.code,null,"req.body"))," gr√¢ce √† la fonction middleware ",r.createElement(t.strong,null,r.createElement(t.code,null,"express.json()"))," appel√©e dans ",r.createElement(t.strong,null,r.createElement(t.code,null,"/app.js"))," :"),"\n",r.createElement(t.pre,null,r.createElement(t.code,{className:"language-js"},"app.use(express.json());\n")),"\n",r.createElement(t.p,null,"Il est donc important de ne pas retirer cette ligne lorsque l'on cr√©e une RESTful API."),"\n",r.createElement(t.p,null,"OK, c'est bien, mais comment tester ce nouveau code ?"),"\n",r.createElement(t.p,null,"Le browser permet de facilement cr√©er des requ√™tes de type ",r.createElement(t.strong,null,"GET"),", mais pas des requ√™tes de type ",r.createElement(t.strong,null,"POST"),"...",r.createElement(t.br),"\n","Nous avons donc besoin d'un client l√©ger permettant de faire des requ√™tes HTTP."),"\n",r.createElement(t.h1,null,r.createElement(c,null," Client REST ")),"\n",r.createElement(t.h2,null,"Introduction"),"\n",r.createElement(t.p,null,"Dans le cadre de ce cours, tout comme g√©n√©ralement dans un environnement professionnel, nous souhaitons pouvoir d√©velopper une API ind√©pendamment du d√©veloppement d'une IHM (Interface Homme Machine, ce sont les √©crans permettant d'interagir avec l'application web)."),"\n",r.createElement(t.p,null,"En effet, cela prendrait trop de temps de devoir d√©velopper un frontend (HTML / JavaScript / CSS) pour tester nos API."),"\n",r.createElement(t.p,null,"Nous allons donc utiliser un client l√©ger permettant de faire des requ√™tes √† nos API.",r.createElement(t.br),"\n","Il en existe de nombreux, comme ",r.createElement(t.a,{href:"https://marketplace.visualstudio.com/items?itemName=humao.rest-client"},"REST Client")," ",r.createElement(t.a,{href:"/web2/references/#r55"},"[R.55]")," ou ",r.createElement(t.a,{href:"https://www.postman.com/"},"Postman")," ",r.createElement(t.a,{href:"/web2/references/#r56"},"[R.56]"),"."),"\n",r.createElement(t.h2,null,"REST Client"),"\n",r.createElement(t.p,null,"Dans le cadre de ce cours, nous utilisons ",r.createElement(t.a,{href:"https://marketplace.visualstudio.com/items?itemName=humao.rest-client"},"REST Client")," ",r.createElement(t.a,{href:"/web2/references/#r55"},"[R.55]")," de Visual Studio Code pour tester nos API."),"\n",r.createElement(t.p,null,"Pour installer REST Client au sein de VS Code, veuillez cliquer sur l'onglet ",r.createElement(t.strong,null,"Extensions"),"."),"\n",r.createElement(t.p,null,"Recherchez l'extension ",r.createElement(t.strong,null,"REST Client")," et cliquez sur ",r.createElement(t.strong,null,"Install"),"."),"\n",r.createElement(t.p,null,"Quelques notions pour utiliser REST Client :"),"\n",r.createElement(t.ul,null,"\n",r.createElement(t.li,null,"Il faut cr√©er un fichier ",r.createElement(t.strong,null,r.createElement(t.code,null,".http"))," (ou ",r.createElement(t.strong,null,r.createElement(t.code,null,".rest")),") contenant les requ√™tes vers vos RESTful APIs.",r.createElement(t.br),"\n","NB : Il est appropri√© de cr√©er un fichier par type de ressources."),"\n",r.createElement(t.li,null,"Chaque requ√™te est introduite par ",r.createElement(t.strong,null,r.createElement(t.code,null,"###")),' (3 "',r.createElement(t.strong,null,r.createElement(t.code,null,"#")),'"" ou plus) ; voici la requ√™te permettant de lire toutes les pizzas :'),"\n"),"\n",r.createElement(t.pre,null,r.createElement(t.code,{className:"language-http"},"### Read all pizzas\r\nGET http://localhost:3000/pizzas\n")),"\n",r.createElement(t.ul,null,"\n",r.createElement(t.li,null,"Pour ex√©cuter une requ√™te, il suffit de cliquer sur ",r.createElement(t.strong,null,r.createElement(t.code,null,"Send Request")),"."),"\n",r.createElement(t.li,null,"Lorsqu'on envoie des donn√©es au format JSON, il est important d'avoir un espace avant les accolades (avant le \"",r.createElement(t.strong,null,r.createElement(t.code,null,"{")),'" ).'),"\n",r.createElement(t.li,null,"On peut d√©finir des ",r.createElement(t.strong,null,"File variables")," via ce genre de syntaxe : ",r.createElement(t.strong,null,r.createElement(t.code,null,"@baseUrl = http://localhost:3000")),"."),"\n",r.createElement(t.li,null,"Pour utiliser la variable ",r.createElement(t.strong,null,r.createElement(t.code,null,"baseUrl")),", il suffit de la mettre entre double accolades. Par exemple, voici la requ√™te permettant de lire toutes les pizzas :"),"\n"),"\n",r.createElement(t.pre,null,r.createElement(t.code,{className:"language-http"},"### Read all pizzas with File variable\r\n@baseUrl = http://localhost:3000\r\nGET {{baseUrl}}/pizzas\n")),"\n",r.createElement(t.p,null,"Nous allons maintenant tester l'API de la pizzeria que nous avons cr√©√©e pour toutes ses op√©rations."),"\n",r.createElement(t.p,null,"Au sein de VS Code, dans votre projet ",r.createElement(t.strong,null,r.createElement(t.code,null,"/tutorials/pizzeria/api/basic")),", veuillez cr√©er un r√©pertoire nomm√© ",r.createElement(t.strong,null,r.createElement(t.code,null,"REST Client")),". Dans ce r√©pertoire, veuillez cr√©er un fichier nomm√© ",r.createElement(t.strong,null,r.createElement(t.code,null,"pizzas.http")),"."),"\n",r.createElement(t.p,null,"Dans ",r.createElement(t.strong,null,r.createElement(t.code,null,"pizzas.http")),", veuillez ajouter cette requ√™te pour la lecture de toutes les pizzas et ex√©cutez la :"),"\n",r.createElement(t.pre,null,r.createElement(t.code,{className:"language-http"},"### Read all pizzas with File variable\r\n@baseUrl = http://localhost:3000\r\nGET {{baseUrl}}/pizzas\n")),"\n",r.createElement(t.p,null,"Est-ce que cela fonctionne bien ?  Avez vous bien d√©marr√© votre API ?",r.createElement(t.br),"\n","Vous devriez obtenir le m√™me r√©sultat que si vous acc√©diez √† votre API √† l'aide du browser."),"\n",r.createElement(t.p,null,"Au sein de ",r.createElement(t.strong,null,r.createElement(t.code,null,"pizzas.http")),", veuillez ajouter ces deux requ√™tes pour la lecture de toutes les pizzas en les triant selon leur titre :"),"\n",r.createElement(t.pre,null,r.createElement(t.code,{className:"language-http"},"### Read all pizzas sorted by title (ascending)\r\nGET {{baseUrl}}/pizzas/?order=+title\r\n\r\n### Read all pizzas sorted by title (descending)\r\nGET {{baseUrl}}/pizzas/?order=-title\n")),"\n",r.createElement(t.p,null,"Veuillez ex√©cuter ces deux requ√™tes."),"\n",r.createElement(t.p,null,"Nous sommes pr√™ts pour ajouter une requ√™te appelant l'op√©ration de cr√©ation d'une pizza."),"\n",r.createElement(t.p,null,"Au sein de ",r.createElement(t.strong,null,r.createElement(t.code,null,"pizzas.http")),", veuillez ajouter cette requ√™te pour la cr√©ation d'une pizza :"),"\n",r.createElement(t.pre,null,r.createElement(t.code,{className:"language-http"},'### Create a pizza\r\nPOST {{baseUrl}}/pizzas\r\nContent-Type: application/json\r\n\r\n{\r\n    "title":"Magic Green",\r\n    "content":"Epinards, Brocolis, Olives vertes, Basilic"\r\n}\n')),"\n",r.createElement(t.p,null,"On remarque qu'il est important de mettre une ligne vide avant les accolades repr√©sentant le body de la requ√™te."),"\n",r.createElement(t.p,null,"üí≠ Comment tester que le bon fonctionnement de l'op√©ration de cr√©ation ?"),"\n",r.createElement(t.p,null,"Et bien il suffit d'ex√©cuter l'op√©ration de lecture de toutes les pizzas üòé !\r\nLors de l'ajout d'un film, si la nouvelle ressource appara√Æt, c'est qu'elle a bien √©t√© cr√©√©e !\r\nFaites le test !"),"\n",r.createElement(t.h1,null,r.createElement(c,null," Exercice 1.3 : lectures sp√©cifiques, cr√©ation & REST Client ")),"\n",r.createElement(t.p,null,"Veuillez continuer le d√©veloppement de la RESTful API de ",r.createElement(t.strong,null,"myMovies"),", sous Express, afin de mettre √† disposition de nouvelles op√©rations sur des films et utiliser ",r.createElement(t.strong,null,"REST Client"),"."),"\n",r.createElement(t.p,null,"Veuillez repartir du code de la solution de votre ",r.createElement(t.a,{href:"#exercice_1_1_lecture_de_toutes_les_ressources"},"Exercice 1.1")," ou de votre ",r.createElement(t.a,{href:"#exercice_1_2_middleware_sexecutant_sur_toutes_les_routes"},"Exercice 1.2")," si celui-ci contient l'op√©ration de lecture de tous les films."),"\n",r.createElement(t.p,null,"Veuillez rajouter ces op√©rations √† votre API :"),"\n",r.createElement(t.table,null,r.createElement(t.thead,null,r.createElement(t.tr,null,r.createElement(t.th,null,"URI"),r.createElement(t.th,null,"M√©thode HTTP"),r.createElement(t.th,null,"Op√©ration"))),r.createElement(t.tbody,null,r.createElement(t.tr,null,r.createElement(t.td,null,r.createElement(t.strong,null,r.createElement(t.code,null,"films?minimum-duration=value"))),r.createElement(t.td,null,"GET"),r.createElement(t.td,null,"READ ALL FILTERED : Lire toutes les ressources de la collection selon le filtre donn√©")),r.createElement(t.tr,null,r.createElement(t.td,null,r.createElement(t.strong,null,r.createElement(t.code,null,"films/{id}"))),r.createElement(t.td,null,"GET"),r.createElement(t.td,null,"READ ONE : Lire la ressource identifi√©e")),r.createElement(t.tr,null,r.createElement(t.td,null,r.createElement(t.strong,null,r.createElement(t.code,null,"films"))),r.createElement(t.td,null,"POST"),r.createElement(t.td,null,"CREATE ONE : Cr√©er une ressource bas√©e sur les donn√©es de la requ√™te")))),"\n",r.createElement("br"),"\n",r.createElement(t.p,null,"Pour rappel, une ressource de type ",r.createElement(t.strong,null,r.createElement(t.code,null,"films"))," doit contenir les propri√©t√©s suivantes :"),"\n",r.createElement(t.ul,null,"\n",r.createElement(t.li,null,r.createElement(t.strong,null,r.createElement(t.code,null,"id"))," : un entier"),"\n",r.createElement(t.li,null,r.createElement(t.strong,null,r.createElement(t.code,null,"title"))," : titre du film (String)"),"\n",r.createElement(t.li,null,r.createElement(t.strong,null,r.createElement(t.code,null,"duration"))," : dur√©e du film en minutes ; elle doit √™tre un nombre positif (pas une string !)."),"\n",r.createElement(t.li,null,r.createElement(t.strong,null,r.createElement(t.code,null,"budget"))," : pour informer du co√ªt qu'a cout√© la production du film, en millions ; le budget doit √™tre un nombre positif (pas une string !)."),"\n",r.createElement(t.li,null,r.createElement(t.strong,null,r.createElement(t.code,null,"link"))," : pour donner une URL vers la description du film (lien vers imdb, rottentomatoes ou autre)."),"\n"),"\n",r.createElement(t.p,null,"Les ressources ne doivent toujours pas persister : d√®s lors, ajoutez les donn√©es associ√©es aux films dans un array."),"\n",r.createElement(t.p,null,"Veuillez bien valider les param√®tres re√ßu par les op√©rations de vos API ; v√©rifiez par exemple que ",r.createElement(t.strong,null,r.createElement(t.code,null,"budget"))," et ",r.createElement(t.strong,null,r.createElement(t.code,null,"duration"))," sont des ",r.createElement(t.strong,null,"nombres positifs"),"."),"\n",r.createElement(t.p,null,"Veuillez ",r.createElement(t.strong,null,"tester toutes les fonctions de la RESTful API")," pour la collection de films √† l'aide du ",r.createElement(t.strong,null,"REST Client")," dans VS Code. Veuillez ajouter vos requ√™tes au sein du fichier ",r.createElement(t.strong,null,r.createElement(t.code,null,"films.http"))," dans le r√©pertoire ",r.createElement(t.strong,null,"REST Client")," du dossier associ√© √† cet exercice."),"\n",r.createElement(t.p,null,"Le code de votre application doit se trouver dans votre repository local et votre web repository (normalement appel√© ",r.createElement(t.strong,null,r.createElement(t.code,null,"web2")),") dans le r√©pertoire nomm√© ",r.createElement(t.strong,null,r.createElement(t.code,null,"/exercises/1.3")),".",r.createElement(t.br),"\n","Veuillez faire un ",r.createElement(t.strong,null,r.createElement(t.code,null,"commit"))," de votre code avec le message suivant : ",r.createElement(t.strong,null,r.createElement(t.code,null,"1.3 : API : create & REST client")),"."),"\n",r.createElement(t.h4,null,"ü§ù Tips"),"\n",r.createElement(t.ul,null,"\n",r.createElement(t.li,null,"D√©veloppez les op√©rations de votre API de mani√®re incr√©mentale : testez une op√©ration via REST Client avant de passer √† une nouvelle op√©ration."),"\n",r.createElement(t.li,null,"Pour le filtre sur les films, vous allez r√©cup√©rer un param√®tre de requ√™te.",r.createElement(t.br),"\n","‚ö° Attention, le signe ",r.createElement(t.strong,null,r.createElement(t.code,null,"-"))," est un op√©rateur en JS, vous ne pouvez pas r√©cup√©rer le param√®tre de requ√™te via ",r.createElement(t.strong,null,r.createElement(t.code,null,"req.query.minimum-duration")),"...",r.createElement(t.br),"\n","üí≠ Mais alors comment faire ?",r.createElement(t.br),"\n","On acc√®de aussi au propri√©t√© d'un objet √† l'aide d'un array, ici √ßa serait via ",r.createElement(t.strong,null,r.createElement(t.code,null,"req.query['minimum-duration']")),"."),"\n",r.createElement(t.li,null,"N'h√©sitez pas √† vous inspirer du code du tutoriel ",r.createElement(t.a,{href:"https://github.com/e-vinci/js-demos/tree/main/backend-restful-api/restful-api-essentials/basic"},"api-basic"),"."),"\n",r.createElement(t.li,null,"Pour v√©rifier le type d'une variable, n'h√©sitez pas √† utiliser l'op√©rateur ",r.createElement(t.strong,null,r.createElement(t.code,null,"typeof")),"."),"\n"),"\n",r.createElement(t.h1,null,r.createElement(c,null," üç¨ Exercice 1.4 : Gestion de la pagination, du tri et du filtrage ")),"\n",r.createElement(t.p,null,"N'h√©sitez pas, c'est optionnel, de g√©rer de nouvelles op√©rations au sein de votre RESTful API de ",r.createElement(t.strong,null,"myMovies")," :"),"\n",r.createElement(t.ul,null,"\n",r.createElement(t.li,null,"Filtrez tous les films qui commencent par une certaines cha√Ænes de caract√®res."),"\n",r.createElement(t.li,null,"Permettez de trier les films."),"\n"),"\n",r.createElement(t.p,null,"Le code de votre application est √† ajouter dans votre repository local et votre web repository (normalement appel√© ",r.createElement(t.strong,null,r.createElement(t.code,null,"web2")),") dans le r√©pertoire nomm√© ",r.createElement(t.strong,null,r.createElement(t.code,null,"/exercises/1.4")),".",r.createElement(t.br),"\n","Veuillez faire un ",r.createElement(t.strong,null,r.createElement(t.code,null,"commit"))," de votre code avec le message suivant : ",r.createElement(t.strong,null,r.createElement(t.code,null,"1.4 : API : ordering & filtering client")),"."),"\n",r.createElement(t.p,null,"üç¨ Et si vraiment vous avez encore du temps et souhaitez d√©j√† approfondir les RESTful APIs, n'h√©sitez pas aussi √† impl√©menter la gestion de la pagination. Pour cette partie, veuillez faire un ",r.createElement(t.strong,null,r.createElement(t.code,null,"commit"))," de votre code avec le message suivant : ",r.createElement(t.strong,null,r.createElement(t.code,null,"1.4 : API : pagination")),"."),"\n",r.createElement(t.h4,null,"ü§ù Tips"),"\n",r.createElement(t.p,null,"Besoin d'inspiration pour l'aspect filtrage et la gestion du tri des ressources ? ",r.createElement(t.a,{href:"https://dev.to/drminnaar/rest-api-guide-14n2"},"REST API Guide")," ",r.createElement(t.a,{href:"/web2/references/#r58"},"[R.58]"),"."),"\n",r.createElement(t.h1,null,r.createElement(c,null," Codes de statut HTTP associ√©s aux r√©ponses ")),"\n",r.createElement("div",{className:"card card__simple-youtube-container"},r.createElement(i,{src:"https://youtu.be/OHd092ILf7g"})),"\n",r.createElement(t.p,null,"On ne peut pas toujours renvoyer du JSON suite √† une requ√™te client ainsi qu'un code HTTP correspondant au fait que tout est OK (",r.createElement(t.strong,null,r.createElement(t.code,null,"200 OK")),")."),"\n",r.createElement(t.p,null,"Quand vous ex√©cutez cette requ√™te :"),"\n",r.createElement(t.pre,null,r.createElement(t.code,{className:"language-http"},"### Read all pizzas with File variable\r\nGET {{baseUrl}}/pizzas\n")),"\n",r.createElement(t.p,null,"Vous faites appel √† l'op√©ration de lecture de toutes les pizzas. La derni√®re ligne de cette op√©ration est la suivante :"),"\n",r.createElement(t.pre,null,r.createElement(t.code,{className:"language-js"},"res.json(orderedMenu ?? MENU);\n")),"\n",r.createElement(t.p,null,"La fonction ",r.createElement(t.strong,null,r.createElement(t.code,null,"json"))," renvoie une r√©ponse au format JSON, mais de plus, elle renvoie un ",r.createElement(t.strong,null,"status code")," ",r.createElement(t.strong,null,r.createElement(t.code,null,"200"))," indiquant au client que tout s'est bien pass√©."),"\n",r.createElement(t.p,null,"Au sein de ",r.createElement(t.strong,null,r.createElement(t.code,null,"pizzas.http")),", veuillez ajouter cette requ√™te pour tenter de cr√©er une pizza en oubliant un param√®tre :"),"\n",r.createElement(t.pre,null,r.createElement(t.code,{className:"language-http"},'### Create a pizza which lacks a property\r\nPOST {{baseUrl}}/pizzas\r\nContent-Type: application/json\r\n\r\n{\r\n    "content":"Epinards, Brocolis, Olives vertes, Basilic"\r\n}\n')),"\n",r.createElement(t.p,null,"Veuillez ex√©cuter cette requ√™te. Que se passe-t-il ?",r.createElement(t.br),"\n","On r√©cup√®re un code d'erreur ",r.createElement(t.strong,null,r.createElement(t.code,null,"400 Bad Request")),"."),"\n",r.createElement(t.p,null,"En effet, lorsqu'on omet un param√®tre dans la repr√©sentation de la ressource √† cr√©er, voici les lignes de code amenant au renvoi du code d'erreur ",r.createElement(t.strong,null,r.createElement(t.code,null,"400"))," au sein de ",r.createElement(t.strong,null,r.createElement(t.code,null,"pizzas.js"))," :"),"\n",r.createElement(t.pre,{numbered:!0,highlighting:"3,4,8"},r.createElement(t.code,{className:"language-js"},"// Create a pizza to be added to the menu.\r\nrouter.post('/', (req, res) => {\r\n  const title = req?.body?.title?.length !== 0 ? req.body.title : undefined;\r\n  const content = req?.body?.content?.length !== 0 ? req.body.content : undefined;\r\n\r\n  console.log('POST /pizzas');\r\n\r\n  if (!title || !content) return res.sendStatus(400); // error code '400 Bad request'\r\n\r\n  const lastItemIndex = MENU?.length !== 0 ? MENU.length - 1 : undefined;\r\n  const lastId = lastItemIndex !== undefined ? MENU[lastItemIndex]?.id : 0;\r\n  const nextId = lastId + 1;\r\n\r\n  const newPizza = {\r\n    id: nextId,\r\n    title: title,\r\n    content: content,\r\n  };\r\n\r\n  MENU.push(newPizza);\r\n\r\n  res.json(newPizza);\r\n});\n")),"\n",r.createElement(t.p,null,"Le client est donc bien inform√© qu'il y a eu un probl√®me lors de l'ex√©cution de l'op√©ration.",r.createElement(t.br),"\n","Il pourrait par exemple utiliser cette information pour pr√©senter un message d'erreur au niveau d'une IHM."),"\n",r.createElement(t.p,null,'Voici les grandes cat√©gories de "status codes" :'),"\n",r.createElement(t.ul,null,"\n",r.createElement(t.li,null,"R√©ponses informatives : ",r.createElement(t.strong,null,r.createElement(t.code,null,"100-199"))),"\n",r.createElement(t.li,null,"R√©ponses en cas de succ√®s : ",r.createElement(t.strong,null,r.createElement(t.code,null,"200-299"))),"\n",r.createElement(t.li,null,"Redirections : ",r.createElement(t.strong,null,r.createElement(t.code,null,"300-399"))),"\n",r.createElement(t.li,null,"Erreurs du client : ",r.createElement(t.strong,null,r.createElement(t.code,null,"400-499"))),"\n",r.createElement(t.li,null,"Erreurs du serveur : ",r.createElement(t.strong,null,r.createElement(t.code,null,"500-599"))),"\n"),"\n",r.createElement(t.p,null,'Voici les "status codes" que nous allons g√©n√©ralement utiliser :'),"\n",r.createElement(t.ul,null,"\n",r.createElement(t.li,null,r.createElement(t.strong,null,r.createElement(t.code,null,"200 OK"))," : tout s'est bien pass√©, Express ajoute ce code automatiquement pour nous quand nous utilisons une m√©thode comme ",r.createElement(t.strong,null,r.createElement(t.code,null,"res.json()")),"."),"\n",r.createElement(t.li,null,r.createElement(t.strong,null,r.createElement(t.code,null,"400 Bad Request"))," : pour indiquer au client que la requ√™te contient des param√®tres non valides ou n'est pas compl√®te."),"\n",r.createElement(t.li,null,r.createElement(t.strong,null,r.createElement(t.code,null,"401 Unauthorized"))," : pour indiquer au client qu'il doit s'authentifier pour acc√©der √† cette op√©ration. On renvoie aussi ce code d'erreur quand un client fournit un mauvais username ou password."),"\n",r.createElement(t.li,null,r.createElement(t.strong,null,r.createElement(t.code,null,"403 Forbidden"))," : le client est connu du serveur, mais il n'a pas les privil√®ges pour acc√©der √† cette op√©ration (par exemple, le client n'est pas admin et tente d'acc√©der √† une op√©ration seulement accessible √† un admin)."),"\n",r.createElement(t.li,null,r.createElement(t.strong,null,r.createElement(t.code,null,"404 Not Found"))," : la ressource demand√©e n'existe pas, bien que l'URL semble valide."),"\n",r.createElement(t.li,null,r.createElement(t.strong,null,r.createElement(t.code,null,"409 Conflict"))," : l'√©tat du serveur entre en conflit avec la requ√™te. Par exemple, la requ√™te demande de cr√©er un utilisateur qui existe d√©j√†."),"\n",r.createElement(t.li,null,r.createElement(t.strong,null,r.createElement(t.code,null,"500 Internal Server Error"))," : le serveur a rencontr√© une erreur qu'il ne peut pas r√©gler. Par exemple, le serveur de base de donn√©es ne r√©pond pas et ne permet donc pas d'acc√©der aux ressources."),"\n"),"\n",r.createElement(t.h1,null,r.createElement(c,null," Exercice 1.5 : codes de statut HTTP ")),"\n",r.createElement(t.p,null,"Veuillez continuer le d√©veloppement de la RESTful API de ",r.createElement(t.strong,null,"myMovies"),", sous Express, afin de mieux g√©rer la la lecture et la cr√©ation de films et le r√©ponses √† donner aux clients."),"\n",r.createElement(t.p,null,"Veuillez repartir du code de la solution de votre ",r.createElement(t.a,{href:"#exercice_1_3_lectures_specifiques_creation_rest_client"},"Exercice 1.3")," ou de votre ",r.createElement(t.a,{href:"#%F0%9F%8D%AC_exercice_1_4_gestion_de_la_pagination_du_tri_et_du_filtrage"},"Exercice 1.4 optionnel"),"."),"\n",r.createElement(t.p,null,"Veuillez am√©liorer les deux op√©rations de lecture (",r.createElement(t.strong,null,r.createElement(t.code,null,"GET /films"))," & ",r.createElement(t.strong,null,r.createElement(t.code,null,"GET /films/:id")),") et l'op√©ration de cr√©ation de films (",r.createElement(t.strong,null,r.createElement(t.code,null,"POST /films")),"):"),"\n",r.createElement(t.ul,null,"\n",r.createElement(t.li,null,"En cas d'√©chec de la validation des param√®tres re√ßus par une op√©ration (non respect du contrat de l'API), veuillez renvoyer le status code appropri√©."),"\n",r.createElement(t.li,null,"Lors de l'√©chec de la lecture d'un film en particulier, veuillez renvoyer le status code appropri√©."),"\n",r.createElement(t.li,null,"Lors de l'ajout d'un film, si la ressource existe d√©j√†, c'est-√†-dire s'il y a d√©j√† un film pr√©sent avec le ",r.createElement(t.strong,null,r.createElement(t.code,null,"title"))," donn√©, veuillez renvoyer le status code appropri√©."),"\n"),"\n",r.createElement(t.p,null,"Le code de votre application doit se trouver dans votre repository local et votre web repository (normalement appel√© ",r.createElement(t.strong,null,r.createElement(t.code,null,"web2")),") dans le r√©pertoire nomm√© ",r.createElement(t.strong,null,r.createElement(t.code,null,"/exercises/1.5")),".",r.createElement(t.br),"\n","Veuillez faire un ",r.createElement(t.strong,null,r.createElement(t.code,null,"commit"))," de votre code avec le message suivant : ",r.createElement(t.strong,null,r.createElement(t.code,null,"1.5 : API : status code")),"."),"\n",r.createElement(t.h1,null,r.createElement(c,null," Op√©rations de suppression & de modification ")),"\n",r.createElement("div",{className:"card card__simple-youtube-container"},r.createElement(i,{src:"https://youtu.be/1AQ9BknswUI"})),"\n",r.createElement(t.h2,null,"Op√©ration de suppression"),"\n",r.createElement(t.p,null,'Nous souhaitons d√©velopper une op√©ration permettant de supprimer une ressource de type "pizzas" √† l\'aide de son identifiant.'),"\n",r.createElement(t.p,null,"Selon les conventions REST, une ",r.createElement(t.strong,null,"op√©ration de suppression"),":"),"\n",r.createElement(t.ul,null,"\n",r.createElement(t.li,null,"est associ√©e √† une requ√™te de type ",r.createElement(t.strong,null,r.createElement(t.code,null,"DELETE /pizzas/{id}"))," contenant l'",r.createElement(t.strong,null,"identifiant")," de la ressource √† supprimer au sein de l'URI comme ",r.createElement(t.strong,null,"param√®tre de route"),"."),"\n",r.createElement(t.li,null,r.createElement(t.strong,null,"ne contient pas de donn√©es dans le body")," et est de ",r.createElement(t.strong,null,"type DELETE"),"."),"\n"),"\n",r.createElement(t.p,null,"Voici le code du router ",r.createElement(t.strong,null,r.createElement(t.code,null,"/routes/pizzas.js"))," pour la nouvelle op√©ration, veuillez la rajouter dans le r√©pertoire de votre tutoriel en cours :"),"\n",r.createElement(t.pre,null,r.createElement(t.code,{className:"language-js"},"// Delete a pizza from the menu based on its id\r\nrouter.delete('/:id', (req, res) => {\r\n  console.log(`DELETE /pizzas/${req.params.id}`);\r\n\r\n  const foundIndex = MENU.findIndex(pizza => pizza.id == req.params.id);\r\n\r\n  if (foundIndex < 0) return res.sendStatus(404);\r\n\r\n  const itemsRemovedFromMenu = MENU.splice(foundIndex, 1);\r\n  const itemRemoved = itemsRemovedFromMenu[0];\r\n\r\n  res.json(itemRemoved);\r\n});\n")),"\n",r.createElement(t.p,null,"Au sein de ",r.createElement(t.strong,null,r.createElement(t.code,null,"pizzas.http")),', veuillez ajouter cette requ√™te pour supprimer la pizza poss√©dant l\'identifiant "2" :'),"\n",r.createElement(t.pre,null,r.createElement(t.code,{className:"language-http"},"### Delete pizza identified by 2\r\nDELETE {{baseUrl}}/pizzas/2\n")),"\n",r.createElement(t.p,null,"Veuillez ex√©cuter cette requ√™te et v√©rifier que la pizza a bien √©t√© supprim√©e."),"\n",r.createElement(t.h2,null,"Op√©ration de modification"),"\n",r.createElement(t.p,null,'Nous souhaitons d√©velopper une op√©ration permettant de modifier une ressource de type "pizzas" √† l\'aide de son identifiant et de nouvelles valeurs pour ses propri√©t√©s.'),"\n",r.createElement(t.p,null,"Selon les conventions REST, une ",r.createElement(t.strong,null,"op√©ration de modification")," :"),"\n",r.createElement(t.ul,null,"\n",r.createElement(t.li,null,"si l'on accepte de modifier que certaines des propri√©t√©s d'une pizza (qu'il ne faut donc pas fournir toutes les propri√©t√©s d'une pizza), est associ√©e √† une requ√™te de type ",r.createElement(t.strong,null,r.createElement(t.code,null,"PATCH /pizzas/{id}"))," contenant l'",r.createElement(t.strong,null,"identifiant")," de la ressource √† supprimer au sein de l'URL comme ",r.createElement(t.strong,null,"param√®tre de route"),"."),"\n",r.createElement(t.li,null,r.createElement(t.strong,null,"contient les nouvelles donn√©es au sein du body")," et est de ",r.createElement(t.strong,null,"type PATCH ou PUT"),"."),"\n"),"\n",r.createElement(t.p,null,"Lors de l'ajout d'un film, si nous souhaitons modifier une ressource identifi√©e par ",r.createElement(t.strong,null,r.createElement(t.code,null,"6")),' en fournissant un nouveau titre "Magic Green 2", la repr√©sentation des donn√©es de la ressource √† modifier sera la suivante :'),"\n",r.createElement(t.pre,null,r.createElement(t.code,{className:"language-json"},'{\r\n    "title":"Magic Green 2"\r\n}\n')),"\n",r.createElement(t.p,null,"Selon les conventions REST, la requ√™te de modification est de type PATCH et contient ses param√®tres au sein du body de la requ√™te."),"\n",r.createElement(t.p,null,"Voici le code du router ",r.createElement(t.strong,null,r.createElement(t.code,null,"/routes/pizzas.js"))," pour la nouvelle op√©ration √† rajouter dans votre tutoriel en cours :"),"\n",r.createElement(t.pre,null,r.createElement(t.code,{className:"language-js"},"// Update a pizza based on its id and new values for its parameters\r\nrouter.patch('/:id', (req, res) => {\r\n  console.log(`PATCH /pizzas/${req.params.id}`);\r\n\r\n  const title = req?.body?.title;\r\n  const content = req?.body?.content;\r\n\r\n  console.log('POST /pizzas');\r\n\r\n  if ((!title && !content) || title?.length === 0 || content?.length === 0) return res.sendStatus(400);\r\n\r\n  const foundIndex = MENU.findIndex(pizza => pizza.id == req.params.id);\r\n\r\n  if (foundIndex < 0) return res.sendStatus(404);\r\n\r\n  const updatedPizza = {...MENU[foundIndex], ...req.body};\r\n\r\n  MENU[foundIndex] = updatedPizza;\r\n\r\n  res.json(updatedPizza);\r\n});\n")),"\n",r.createElement(t.p,null,"Au sein de ",r.createElement(t.strong,null,r.createElement(t.code,null,"pizzas.http")),', veuillez ajouter cette requ√™te pour modifier la pizza poss√©dant l\'identifiant "6" :'),"\n",r.createElement(t.pre,null,r.createElement(t.code,{className:"language-http"},'### Update the pizza identified by 6\r\nPATCH {{baseUrl}}/pizzas/6\r\nContent-Type: application/json\r\n\r\n{\r\n    "title":"Magic Green 2"\r\n}\n')),"\n",r.createElement(t.p,null,"Veuillez ex√©cuter cette requ√™te et v√©rifier que la pizza a bien √©t√© modifi√©e."),"\n",r.createElement(t.p,null,"üí≠ Cela ne fonctionne pas ?",r.createElement(t.br),"\n","Avez vous pr√©c√©demment ex√©cut√© la requ√™te permettant de cr√©er une sixi√®me pizza."),"\n",r.createElement(t.p,null,"Lors de l'ajout d'un film, si votre tutoriel fonctionne bien, faites un ",r.createElement(t.strong,null,"commit")," de votre repo (",r.createElement(t.strong,null,"web2"),") avec comme message : ",r.createElement(t.strong,null,r.createElement(t.code,null,"api-basic tutorial")),"."),"\n",r.createElement(t.p,null,"En cas de souci, vous pouvez acc√©der au code du tutoriel ici : ",r.createElement(t.a,{href:"https://github.com/e-vinci/js-demos/tree/main/backend-restful-api/restful-api-essentials/basic"},"api-basic"),"."),"\n",r.createElement(t.h1,null,r.createElement(c,null," Exercice 1.6 : suppression & modification de ressources ")),"\n",r.createElement(t.p,null,"Veuillez continuer le d√©veloppement de la RESTful API de ",r.createElement(t.strong,null,"myMovies"),", sous Express, afin d'ajouter les op√©rations de suppression et de modification de ressources."),"\n",r.createElement(t.p,null,"Veuillez repartir du code de la solution de votre ",r.createElement(t.a,{href:"#exercice_1_5_codes_de_statut_http"},"Exercice 1.5"),"."),"\n",r.createElement(t.p,null,"Veuillez ajouter ces trois nouvelles op√©rations :"),"\n",r.createElement(t.table,null,r.createElement(t.thead,null,r.createElement(t.tr,null,r.createElement(t.th,null,"URI"),r.createElement(t.th,null,"M√©thode HTTP"),r.createElement(t.th,null,"Op√©ration"))),r.createElement(t.tbody,null,r.createElement(t.tr,null,r.createElement(t.td,null,r.createElement(t.strong,null,r.createElement(t.code,null,"films/{id}"))),r.createElement(t.td,null,"DELETE"),r.createElement(t.td,null,"DELETE ONE : Effacer la ressource identifi√©e")),r.createElement(t.tr,null,r.createElement(t.td,null,r.createElement(t.strong,null,r.createElement(t.code,null,"films/{id}"))),r.createElement(t.td,null,"PATCH"),r.createElement(t.td,null,"UPDATE ONE : Mettre √† jour les propri√©t√©s de la ressource par les valeurs donn√©es dans la requ√™te, pour une ou plusieurs propri√©t√©s")),r.createElement(t.tr,null,r.createElement(t.td,null,r.createElement(t.strong,null,r.createElement(t.code,null,"films/{id}"))),r.createElement(t.td,null,"PUT"),r.createElement(t.td,null,"UPDATE ONE or CREATE ONE : Remplacer la ressource par une ressource reprenant les valeurs donn√©es dans la requ√™te, seulement si toutes les propri√©t√©s de la ressource sont donn√©es ! Si la ressource n'existe pas, cr√©er cette ressource seulement si l'",r.createElement(t.strong,null,"id")," donn√© n'est pas d√©j√† existant.")))),"\n",r.createElement(t.p,null,"Veuillez bien valider les param√®tres re√ßus par les op√©rations de vos API ; v√©rifiez par exemple que ",r.createElement(t.strong,null,r.createElement(t.code,null,"budget"))," et ",r.createElement(t.strong,null,r.createElement(t.code,null,"duration"))," sont des ",r.createElement(t.strong,null,"nombres positifs"),"."),"\n",r.createElement(t.p,null,"Veuillez ",r.createElement(t.strong,null,"tester toutes les fonctions de la RESTful API")," pour la collection de films √† l'aide du ",r.createElement(t.strong,null,"REST Client")," dans VS Code. Veuillez ajouter vos requ√™tes au sein du fichier ",r.createElement(t.strong,null,r.createElement(t.code,null,"films.http"))," dans le r√©pertoire ",r.createElement(t.strong,null,"REST Client")," du dossier associ√© √† cet exercice."),"\n",r.createElement(t.p,null,"Le code de votre application doit se trouver dans votre repository local et votre web repository (normalement appel√© ",r.createElement(t.strong,null,r.createElement(t.code,null,"web2")),") dans le r√©pertoire nomm√© ",r.createElement(t.strong,null,r.createElement(t.code,null,"/exercises/1.6")),".",r.createElement(t.br),"\n","Veuillez faire un ",r.createElement(t.strong,null,r.createElement(t.code,null,"commit"))," de votre code avec le message suivant : ",r.createElement(t.strong,null,r.createElement(t.code,null,"1.6 : API : delete & modify")),"."))}var s=function(e){void 0===e&&(e={});const{wrapper:t}=Object.assign({},(0,l.ah)(),e.components);return t?r.createElement(t,e,r.createElement(a,e)):a(e)};function u(e,t){throw new Error("Expected "+(t?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}var o=n(4160),c=n(5583),i=n(5679),m=n(307),d=n(7410),p=n(9523),E=n(8075),g=n(9063),f=n(1631),z=n(5772),v=n(2770),h=n(7008),b=n(9771),q=n(1218),T=(n(5258),n(9394)),x=n(4579),P=n(7743),y=n(9256),j=n(6488),I=n(5175),R=n(6387),w=n(6044);const S={Link:o.Link,Image:i.Z,Section:m.Z,Content:d.Z,Background:p.Z,SectionHeader:E.Z,SectionFooter:g.Z,PageHeader:f.Z,CodeBlock:v.Z,LinkFile:h.Z,ScrollableImage:b.Z,PublicProjectsView:q.Z,AuthenticatedBlock:T.Z,UnAuthenticatedBlock:x.Z,NestedMdxBlock:P.Z,YoutubeImage:y.Z,InternalPageMenu:j.Z,InternalPageMenuItem:I.Z,InternalPageTitle:R.Z,PathViewer:w.k,PathViewerItem:w.F};function N(e){var t,n,a,s,u;let{data:{mdx:o,allImages:i},children:m}=e;return S.PageHeader=(0,z.u)(f.Z,null==o?void 0:o.frontmatter),r.createElement(c.Z,Object.assign({},null!=o&&o.frontmatter?{frontmatter:o.frontmatter}:{},null!=o&&null!==(t=o.frontmatter)&&void 0!==t&&t.navbarExtraStyles?{navbarExtraStyles:o.frontmatter.navbarExtraStyles}:{},null!=o&&null!==(n=o.frontmatter)&&void 0!==n&&n.headerImage?{headerImage:o.frontmatter.headerImage}:{},null!=o&&null!==(a=o.frontmatter)&&void 0!==a&&a.featuredImage?{featuredImage:o.frontmatter.featuredImage}:{},null!=o&&null!==(s=o.frontmatter)&&void 0!==s&&s.title?{pageTitle:o.frontmatter.title}:{},i&&i.length>0?{allImages:i}:{}),r.createElement(l.Zo,{components:S},r.createElement("div",{className:null!=o&&null!==(u=o.frontmatter)&&void 0!==u&&u.autoMargin?"page page--auto-margin ":"page"},m)))}function A(e){return r.createElement(N,e,r.createElement(s,e))}}}]);
//# sourceMappingURL=component---src-templates-mdx-pages-js-content-file-path-src-mdx-pages-part-1-express-api-fr-mdx-610c26958bd2084145a4.js.map